define(function(require,module,exports){require("jquery"),require("underscore"),require("kkpager"),require("kkpagerCss"),require("layDate"),$(function(){var App=function(){this.url={elevatorList:"searchElevator.html"},this.tpl={elevatorTpl:_.template($("#listTpl").html())},this.getQuery=function(){function setKeyVal(obj,key,val){val&&(obj[key]=val)}var province=$("#province").val(),city=$("#city").val(),area=$("#area").val(),cooperStart=$("#cooperStart").val(),cooperEnd=$("#cooperEnd").val(),param={};return setKeyVal(param,"province",province),setKeyVal(param,"city",city),setKeyVal(param,"area",area),setKeyVal(param,"cooperStart",cooperStart),setKeyVal(param,"cooperEnd",cooperEnd),param},this.init(),this.citySelect(),this.dateSelect(),this.loadList(this.getQuery()),this.searchEvelator()};App.prototype={init:function(){},citySelect:function(){require.async("cxSelect",function(){$("#groupSelect").cxSelect({url:"js/plugin/cxSelect/cityData.min.js",selects:["province","city","area"]})})},dateSelect:function(){var start={elem:"#cooperStart",format:"YYYY-MM-DD",choose:function(datas){end.min=datas,end.start=datas}},end={elem:"#cooperEnd",format:"YYYY-MM-DD",choose:function(datas){start.max=datas}};laydate(start),laydate(end)},loadList:function(query){console.log("load");var self=this,$listTable=$("#listTable"),$listTbody=$("#listBody"),pageSize=5,param=query;param.current=1,param.pageSize=pageSize,$.ajax({url:self.url.elevatorList,type:"get",data:param,dataType:"json",success:function(data){if(data.result)if(data.pages&&data.pages.total>0){var html=self.tpl.elevatorTpl(data);console.log(html),$listTbody.html(html),$listTable.removeClass("hide"),kkpager.generPageHtml({pagerid:"kkpager",pno:data.pages.currentPage,total:data.pages.pages,totalRecords:data.pages.total,isShowFirstPageBtn:!1,isShowLastPageBtn:!1,isShowTotalPage:!1,isShowTotalRecords:!1,isGoPage:!0,isShowCurrPage:!1,lang:{prePageText:"<",nextPageText:">"},mode:"click",click:function(n,total,totalRecords){param.current=n,$.ajax({type:"get",url:self.url.elevatorList,data:param,dataType:"json",success:function(data){var html=self.tpl.elevatorTpl(data);$listTbody.html(html)}}),this.selectPage(n)},getHref:function(n){return"javascript:;"}})}else $listTable.addClass("hide"),$("#kkpager").html('<p style="line-height:200px;">'+data.msg+"</p>");else $listTable.addClass("hide"),$("#kkpager").html('<p style="line-height:200px;">'+data.msg+"</p>")},error:function(){console.log("error")}})},searchEvelator:function(){var self=this;$("#searchBtn").on("click",function(){self.loadList(self.getQuery())})}},app=new App})});